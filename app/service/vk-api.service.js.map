{"version":3,"file":"vk-api.service.js","sourceRoot":"","sources":["vk-api.service.ts"],"names":[],"mappings":";;;;;;;;;;;;;QAQM,OAAO,EACP,KAAK;;;;;;;;;;;;;;;;;;YAHX,oCAAoC;YAE9B,OAAO,GAAG,4BAA4B,CAAC;YACvC,KAAK,GAAG,MAAM,CAAC;YAGrB;gBAEE,sBACY,MAAa,EACb,MAAwB,EACxB,WAAyB;oBAFzB,WAAM,GAAN,MAAM,CAAO;oBACb,WAAM,GAAN,MAAM,CAAkB;oBACxB,gBAAW,GAAX,WAAW,CAAc;gBAGrC,CAAC;gBAED,6BAAM,GAAN,UAAO,IAAI,EAAE,MAAW;oBAAxB,iBAcC;oBAdY,sBAAW,GAAX,WAAW;oBACtB,MAAM,CAAC,IAAI,CAAC,MAAM;yBACb,GAAG,CAAC,KAAG,OAAO,GAAG,IAAI,SAAI,IAAI,CAAC,SAAS,CAAC,MAAM,CAAG,CAAC;yBAClD,GAAG,CAAC,UAAA,GAAG,IAAI,OAAA,GAAG,CAAC,IAAI,EAAE,EAAV,CAAU,CAAC;yBACtB,MAAM,CAAC,UAAA,GAAG;wBACT,EAAE,CAAC,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,CAAC;4BACjB,MAAM,CAAC,GAAG,CAAC;wBACb,CAAC;wBAAC,IAAI,CAAC,CAAC;4BACN,KAAI,CAAC,WAAW,CAAC,SAAS,CAAC,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;4BAChD,EAAE,CAAC,CAAC,GAAG,CAAC,KAAK,IAAI,GAAG,CAAC,KAAK,CAAC,UAAU,IAAI,CAAC,CAAC,CAAC,CAAC;gCAC3C,MAAM,CAAC,GAAG,CAAC;4BACb,CAAC;wBACH,CAAC;oBACH,CAAC,CAAC,CAAA;gBACR,CAAC;gBAED,gCAAS,GAAT,UAAU,MAAc;oBACtB,IAAI,EAAE,GAAG,EAAE,CAAC;oBAEZ,EAAE,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;wBACtB,MAAM,CAAC,cAAc,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC;oBAC7C,CAAC;oBAED,MAAM,CAAC,GAAG,CAAC,GAAG,KAAK,CAAC;oBACpB,MAAM,CAAC,UAAU,CAAC,GAAG,gBAAgB,CAAC;oBAEtC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,UAAA,CAAC,IAAI,OAAA,EAAE,CAAC,IAAI,CAAI,CAAC,SAAI,MAAM,CAAC,CAAC,CAAG,CAAC,EAA5B,CAA4B,CAAC,CAAC;oBAE/D,MAAM,CAAC,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA;gBACrB,CAAC;gBAxCH;oBAAC,iBAAU,EAAE;;gCAAA;gBA2Cb,mBAAC;YAAD,CAAC,AA1CD,IA0CC;YA1CD,uCA0CC,CAAA","sourcesContent":["import {Injectable} from \"angular2/core\";\nimport {Jsonp} from \"angular2/http\";\nimport {ErrorService} from \"./error.service\";\nimport {DataStoreService} from \"./data-store.service\";\nimport \"rxjs/add/operator/map\";\nimport \"rxjs/add/operator/filter\";\n// import \"rxjs/add/operator/delay\";\n\nconst API_URL = 'https://api.vk.com/method/';\nconst API_V = '5.52';\n\n@Injectable()\nexport class VkApiService {\n\n  constructor(\n      private _jsonp: Jsonp,\n      private _store: DataStoreService,\n      private _errService: ErrorService\n  ) {\n\n  }\n\n  method(name, params = {}) {\n    return this._jsonp\n        .get(`${API_URL}${name}?${this.getParams(params)}`)\n        .map(res => res.json())\n        .filter(res => {\n          if (res.response) {\n            return res;\n          } else {\n            this._errService.pushError(res.error.error_msg);\n            if (res.error && res.error.error_code == 6) {\n              return res;\n            }\n          }\n        })\n  }\n\n  getParams(params: Object) {\n    let qs = [];\n\n    if (this._store.token) {\n      params['access_token'] = this._store.token;\n    }\n\n    params['v'] = API_V;\n    params['callback'] = 'JSONP_CALLBACK';\n\n    Object.keys(params).forEach(k => qs.push(`${k}=${params[k]}`));\n\n    return qs.join('&')\n  }\n\n\n}\n"]}